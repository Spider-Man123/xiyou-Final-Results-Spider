from selenium import webdriver
from selenium.webdriver.chrome.options import Options
import time
import tkinter as tk
import random
def chaxun():#模拟登陆，登陆后进行点击查询
    m=link.get()
    n=link2.get()
    url='http://www.zfjw.xupt.edu.cn/jwglxt/cjcx/cjcx_cxDgXscj.html?gnmkdm=N305005&layout=default&su={}'.format('m')
    chrome_options = Options()
    chrome_options.add_argument('--headless')
    browser = webdriver.Chrome(options=chrome_options)
    browser .get(url)
    input=browser .find_element_by_xpath('//*[@id="yhm"]')
    input.send_keys(m)
    input1=browser .find_element_by_xpath('//*[@id="mm"]')
    input1.send_keys(n)
    m1=browser .find_element_by_xpath('//*[@id="dl"]')
    m1.click()
    r=browser .find_element_by_xpath('//*[@id="search_go"]')
    r.click()
    time.sleep(3)
    #随机生成一个数字，进行对图片的保存
    a = random.choice([1, 2, 3, 4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30])
    p=a
    #找到所需信息路径进行截图
    browser.find_element_by_xpath('//*[@id="gbox_tabGrid"]').screenshot('chengji{}.png'.format(p))
    window.destroy()
    top = tk.Tk()
    top.title('spider-man.西安邮电大学成绩查询')
    top.geometry('700x500')
    canva = tk.Canvas(top,height=500,width=700)
    image_files = tk.PhotoImage(file='chengji{}.png'.format(p))
    canva.create_image(0, 0, anchor='nw',image=image_files)
    canva.pack()
    top.mainloop()
window=tk.Tk()
window.title('spider-man.西安邮电大学成绩查询')
window.geometry ('400x500')
canvas=tk.Canvas(window,bg='blue',height=135,width=190)
image_file=tk.PhotoImage (file='1.png')
canvas .create_image(0,0,anchor='nw',image=image_file)
canvas .pack()
l=tk.Label (window,text='请输入账号',bg='yellow',font=('Calibri',25),width=10,height=2)
l.pack()
link= tk.Entry(window,width=20)
link.pack()
l2=tk.Label (window,text='请输入密码',bg='yellow',font=('Calibri',25),width=10,height=2)
l2.pack()
link2=tk.Entry(window,width=20,show='*')
link2.pack()
b=tk.Button (window,text='查询',bg='orange',font=('Calibri',25),width=10,height=1,command=chaxun)
b.pack()
c=tk.Label(window,text='出现BUG加我QQ：1220785153',font=('黑体,10'),width=30,height=2)
c.pack()
window.mainloop()
